# Experimental CSR access test
# Generated by gen_csr_test.py (part of riscv-dv)
# Manual edits to fit with BSP and enhance debug
.include "user_define.h"
.section .text.start
.globl _start
.section .text
#.include "user_init.s"
.type _start, @function

_start:
    j _start_main

.globl _start_main
.section .text
_start_main:


############################################
#
# Generated code starts here generated...
#
############################################

	# mstatus
	li x15, 0xa5a5a5a5
	csrrw x2, 768, x15
	li x15, 0x00001800
	bne x15, x2, csr_fail
	li x15, 0x5a5a5a5a
	csrrw x2, 768, x15
	li x15, 0x00001880
	bne x15, x2, csr_fail
	li x15, 0x461b1c7b
	csrrw x2, 768, x15
	li x15, 0x00001808
	bne x15, x2, csr_fail
	li x15, 0xa5a5a5a5
	csrrs x2, 768, x15
	li x15, 0x00001808
	bne x15, x2, csr_fail
	li x15, 0x5a5a5a5a
	csrrs x2, 768, x15
	li x15, 0x00001888
	bne x15, x2, csr_fail
	li x15, 0x4f2469de
	csrrs x2, 768, x15
	li x15, 0x00001888
	bne x15, x2, csr_fail
	li x15, 0xa5a5a5a5
	csrrc x2, 768, x15
	li x15, 0x00001888
	bne x15, x2, csr_fail
	li x15, 0x5a5a5a5a
	csrrc x2, 768, x15
	li x15, 0x00001808
	bne x15, x2, csr_fail
	li x15, 0x1aa21254
	csrrc x2, 768, x15
	li x15, 0x00001800
	bne x15, x2, csr_fail
	csrrwi x2, 768, 0b00101
	li x15, 0x00001800
	bne x15, x2, csr_fail
	csrrwi x2, 768, 0b11010
	li x15, 0x00001800
	bne x15, x2, csr_fail
	csrrwi x2, 768, 0b10001
	li x15, 0x00001808
	bne x15, x2, csr_fail
	csrrsi x2, 768, 0b00101
	li x15, 0x00001800
	bne x15, x2, csr_fail
	csrrsi x2, 768, 0b11010
	li x15, 0x00001800
	bne x15, x2, csr_fail
	csrrsi x2, 768, 0b01111
	li x15, 0x00001808
	bne x15, x2, csr_fail
	csrrci x2, 768, 0b00101
	li x15, 0x00001808
	bne x15, x2, csr_fail
	csrrci x2, 768, 0b11010
	li x15, 0x00001808
	bne x15, x2, csr_fail
	csrrci x2, 768, 0b00000
	li x15, 0x00001800
	bne x15, x2, csr_fail
	# misa
	li x15, 0xa5a5a5a5
	csrrw x2, 769, x15
	li x15, 0x40801104
	bne x15, x2, csr_fail
	li x15, 0x5a5a5a5a
	csrrw x2, 769, x15
	li x15, 0x40801104
	bne x15, x2, csr_fail
	li x15, 0xb6f9d554
	csrrw x2, 769, x15
	li x15, 0x40801104
	bne x15, x2, csr_fail
	li x15, 0xa5a5a5a5
	csrrs x2, 769, x15
	li x15, 0x40801104
	bne x15, x2, csr_fail
	li x15, 0x5a5a5a5a
	csrrs x2, 769, x15
	li x15, 0x40801104
	bne x15, x2, csr_fail
	li x15, 0x57f503b7
	csrrs x2, 769, x15
	li x15, 0x40801104
	bne x15, x2, csr_fail
	li x15, 0xa5a5a5a5
	csrrc x2, 769, x15
	li x15, 0x40801104
	bne x15, x2, csr_fail
	li x15, 0x5a5a5a5a
	csrrc x2, 769, x15
	li x15, 0x40801104
	bne x15, x2, csr_fail
	li x15, 0x46cb28cc
	csrrc x2, 769, x15
	li x15, 0x40801104
	bne x15, x2, csr_fail
	csrrwi x2, 769, 0b00101
	li x15, 0x40801104
	bne x15, x2, csr_fail
	csrrwi x2, 769, 0b11010
	li x15, 0x40801104
	bne x15, x2, csr_fail
	csrrwi x2, 769, 0b01110
	li x15, 0x40801104
	bne x15, x2, csr_fail
	csrrsi x2, 769, 0b00101
	li x15, 0x40801104
	bne x15, x2, csr_fail
	csrrsi x2, 769, 0b11010
	li x15, 0x40801104
	bne x15, x2, csr_fail
	csrrsi x2, 769, 0b01000
	li x15, 0x40801104
	bne x15, x2, csr_fail
	csrrci x2, 769, 0b00101
	li x15, 0x40801104
	bne x15, x2, csr_fail
	csrrci x2, 769, 0b11010
	li x15, 0x40801104
	bne x15, x2, csr_fail
	csrrci x2, 769, 0b11111
	li x15, 0x40801104
	bne x15, x2, csr_fail
	# mie
	li x15, 0xa5a5a5a5
	csrrw x2, 772, x15
	li x15, 0x00000000
	bne x15, x2, csr_fail
	li x15, 0x5a5a5a5a
	csrrw x2, 772, x15
	li x15, 0xa5a50080
	bne x15, x2, csr_fail
	li x15, 0xf2d4a433
	csrrw x2, 772, x15
	li x15, 0x5a5a0808
	bne x15, x2, csr_fail
	li x15, 0xa5a5a5a5
	csrrs x2, 772, x15
	li x15, 0xf2d40000
	bne x15, x2, csr_fail
	li x15, 0x5a5a5a5a
	csrrs x2, 772, x15
	li x15, 0xf7f50080
	bne x15, x2, csr_fail
	li x15, 0x8029ce7c
	csrrs x2, 772, x15
	li x15, 0xffff0888
	bne x15, x2, csr_fail
	li x15, 0xa5a5a5a5
	csrrc x2, 772, x15
	li x15, 0xffff0888
	bne x15, x2, csr_fail
	li x15, 0x5a5a5a5a
	csrrc x2, 772, x15
	li x15, 0x5a5a0808
	bne x15, x2, csr_fail
	li x15, 0x8a36f3c2
	csrrc x2, 772, x15
	li x15, 0x00000000
	bne x15, x2, csr_fail
	csrrwi x2, 772, 0b00101
	li x15, 0x00000000
	bne x15, x2, csr_fail
	csrrwi x2, 772, 0b11010
	li x15, 0x00000000
	bne x15, x2, csr_fail
	csrrwi x2, 772, 0b01010
	li x15, 0x00000008
	bne x15, x2, csr_fail
	csrrsi x2, 772, 0b00101
	li x15, 0x00000008
	bne x15, x2, csr_fail
	csrrsi x2, 772, 0b11010
	li x15, 0x00000008
	bne x15, x2, csr_fail
	csrrsi x2, 772, 0b11011
	li x15, 0x00000008
	bne x15, x2, csr_fail
	csrrci x2, 772, 0b00101
	li x15, 0x00000008
	bne x15, x2, csr_fail
	csrrci x2, 772, 0b11010
	li x15, 0x00000008
	bne x15, x2, csr_fail
	csrrci x2, 772, 0b11011
	li x15, 0x00000000
	bne x15, x2, csr_fail
	# mscratch
	li x15, 0xa5a5a5a5
	csrrw x2, 832, x15
	li x15, 0x00000000
	bne x15, x2, csr_fail
	li x15, 0x5a5a5a5a
	csrrw x2, 832, x15
	li x15, 0xa5a5a5a5
	bne x15, x2, csr_fail
	li x15, 0x4d91835c
	csrrw x2, 832, x15
	li x15, 0x5a5a5a5a
	bne x15, x2, csr_fail
	li x15, 0xa5a5a5a5
	csrrs x2, 832, x15
	li x15, 0x4d91835c
	bne x15, x2, csr_fail
	li x15, 0x5a5a5a5a
	csrrs x2, 832, x15
	li x15, 0xedb5a7fd
	bne x15, x2, csr_fail
	li x15, 0x55627c93
	csrrs x2, 832, x15
	li x15, 0xffffffff
	bne x15, x2, csr_fail
	li x15, 0xa5a5a5a5
	csrrc x2, 832, x15
	li x15, 0xffffffff
	bne x15, x2, csr_fail
	li x15, 0x5a5a5a5a
	csrrc x2, 832, x15
	li x15, 0x5a5a5a5a
	bne x15, x2, csr_fail
	li x15, 0xd8b25102
	csrrc x2, 832, x15
	li x15, 0x00000000
	bne x15, x2, csr_fail
	csrrwi x2, 832, 0b00101
	li x15, 0x00000000
	bne x15, x2, csr_fail
	csrrwi x2, 832, 0b11010
	li x15, 0x00000005
	bne x15, x2, csr_fail
	csrrwi x2, 832, 0b11100
	li x15, 0x0000001a
	bne x15, x2, csr_fail
	csrrsi x2, 832, 0b00101
	li x15, 0x0000001c
	bne x15, x2, csr_fail
	csrrsi x2, 832, 0b11010
	li x15, 0x0000001d
	bne x15, x2, csr_fail
	csrrsi x2, 832, 0b10010
	li x15, 0x0000001f
	bne x15, x2, csr_fail
	csrrci x2, 832, 0b00101
	li x15, 0x0000001f
	bne x15, x2, csr_fail
	csrrci x2, 832, 0b11010
	li x15, 0x0000001a
	bne x15, x2, csr_fail
	csrrci x2, 832, 0b01100
	li x15, 0x00000000
	bne x15, x2, csr_fail
	csrr x2, 832
	li x15, 0x00000000
	bne x15, x2, csr_fail

############################################
#
# Manually generated
#
############################################
test_done:
    lui a0,print_port>>12
    addi a1,zero,'\n'
    sw a1,0(a0)
    addi a1,zero,'C'
    sw a1,0(a0)
    addi a1,zero,'V'
    sw a1,0(a0)
    addi a1,zero,'3'
    sw a1,0(a0)
    addi a1,zero,'2'
    sw a1,0(a0)
    addi a1,zero,' '
    sw a1,0(a0)
    addi a1,zero,'D'
    sw a1,0(a0)
    addi a1,zero,'O'
    sw a1,0(a0)
    addi a1,zero,'N'
    sw a1,0(a0)
    addi a1,zero,'E'
    sw a1,0(a0)
    addi a1,zero,'\n'
    sw a1,0(a0)
    sw a1,0(a0)

csr_pass:
    li x18, 123456789
    li x17, 0x20000000
    sw x18,0(x17)
    wfi

csr_fail:
    lui a0,print_port>>12
    addi a1,zero,'\n'
    sw a1,0(a0)
    addi a1,zero,'C'
    sw a1,0(a0)
    addi a1,zero,'V'
    sw a1,0(a0)
    addi a1,zero,'3'
    sw a1,0(a0)
    addi a1,zero,'2'
    sw a1,0(a0)
    addi a1,zero,' '
    sw a1,0(a0)
    addi a1,zero,'F'
    sw a1,0(a0)
    addi a1,zero,'A'
    sw a1,0(a0)
    addi a1,zero,'I'
    sw a1,0(a0)
    addi a1,zero,'L'
    sw a1,0(a0)
    addi a1,zero,'\n'
    sw a1,0(a0)
    sw a1,0(a0)

    li x18, 1
    li x17, 0x20000000
    sw x18,0(x17)
    wfi
